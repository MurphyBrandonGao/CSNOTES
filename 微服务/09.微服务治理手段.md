# 09 微服务治理手段

一次服务调用，服务提供者、注册中心、网络这三者都可能会有问题，此时服务消费者应该如何处理才能确保调用成功 呢?这就是服务治理要解决的问题。

## 节点管理

### 1、注册中心主动摘除机制

这种机制要求服务提供者定时的主动向注册中心汇报心跳，注册中心根据服务提供者节点最近一次汇报心跳的时间与上一次汇 报心跳时间做比较，如果超出一定时间，就认为服务提供者出现问题，继而把节点从服务列表中摘除，并把最近的可用服务节 点列表推送给服务消费者。

### 2、服务消费者摘除机制

如果服务消费者调用服务提供者节点失败，就将这个节点从内存 中保存的可用服务提供者节点列表中移除。

## 负载均衡

### 1、轮询算法

### 2、加权随机算法

### 3、最小连接数算法

### 4、一致性哈希算法

## 服务路由

### 1、业务存在灰度发布的需求

### 2、多机房就近访问的需求

### 1、静态配置

就是在服务消费者本地存放服务调用的路由规则，在服务调用期间，路由规则不会发生改变，要想改变就需要修改服务消费者本地配置，上线后才能生效。

### 2、动态配置

路由规则是存在注册中心的，服务消费者定期去请求注册中心来保持同步，要想改变服务消费者的路由配置，可以通过修改注册中心的配置，服务消费者在下一个同步周期之后，就会请求注册中心来更新配置，从而实现动态更新。

## 服务容错

- FailOver
- FailSafe
- FailFast
- FailBack